function applyNameFilters(rows) {
  // Se A ou B tiverem um clube selecionado, forçamos a exclusão
  const isClubMode = Boolean($('filtroClubeA').value || $('filtroClubeB').value);

  // Liga se o usuário marcou OU se estamos em modo por-clube
  const supOn  = $('eliminarSuprema').checked || isClubMode;
  const toniOn = $('eliminarToni').checked   || isClubMode;

  if (!supOn && !toniOn) return rows;

  const supSet  = new Set(EMAILS_SUPREMA.map(e => e.toLowerCase()));
  const toniSet = new Set(EMAILS_TONI.map(e => e.toLowerCase()));

  // Extrai todos os e-mails possíveis da linha (coluna de usuário, e-mail etc.)
  const getRowEmails = (row) => {
    const bag = new Set();
    const push = v => {
      if (!v) return;
      const s = String(v).toLowerCase();
      const ms = s.match(/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}/g);
      if (ms) ms.forEach(x => bag.add(x.trim()));
    };
    if (COLS?.email) push(row[COLS.email]);
    if (COLS?.club)  push(row[COLS.club]);
    // varre a linha toda — planilhas mudam muito de coluna
    Object.values(row).forEach(push);
    return bag;
  };

  const hasFromList = (emailSet, listSet) =>
    [...emailSet].some(e => listSet.has(e) || [...listSet].some(b => e.includes(b)));

  return rows.filter(r => {
    const emails = getRowEmails(r);
    const isSup  = supOn  && hasFromList(emails, supSet);
    const isToni = toniOn && hasFromList(emails, toniSet);
    return !(isSup || isToni);
  });
}
