console.log("Rodando versão minificada com filtros e gráficos animados");let dadosNormalizados=[];function carregarDados(){console.log("Iniciando carregamento do CSV..."),Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vQ21mvugq-_T80mCuddCnebiH30MWwJvQ58QiS9OqzHJuTXEVPsOFa9_Apzt4e9rlrLEeQtc8p60t80/pub?gid=0&single=true&output=csv",{download:!0,header:!0,complete:function(a){console.log("Linhas recebidas:",a.data.length);const b=a.data[0]?Object.keys(a.data[0]):[];console.log("Colunas detectadas:",b);dadosNormalizados=a.data.map(c=>({data:c["DATA"],clube:c["Usuário - Nome de usuário do principal"],ftd:parseFloat(c["Usuário - FTD-Montante"]||0),depositos:parseFloat(c["Usuário - Depósitos"]||0),ggr:parseFloat(c["GGR"]||0)})),console.log("Primeiras 5 linhas normalizadas:",dadosNormalizados.slice(0,5)),atualizarDashboard()}})}function atualizarDashboard(){const a=dadosNormalizados.reduce((b,c)=>(b.ftd+=c.ftd||0,b.depositos+=c.depositos||0,b.ggr+=c.ggr||0,b),{ftd:0,depositos:0,ggr:0});document.getElementById("valorFTD").textContent="R$ "+a.ftd.toLocaleString("pt-BR"),document.getElementById("valorDepositos").textContent="R$ "+a.depositos.toLocaleString("pt-BR"),document.getElementById("valorGGR").textContent="R$ "+a.ggr.toLocaleString("pt-BR"),console.log(`Totais calculados -> FTD: ${a.ftd}, Depósitos: ${a.depositos}, GGR: ${a.ggr}`),atualizarGraficos()}function atualizarGraficos(){new Chart(document.getElementById("graficoGGR"),{type:"line",data:{labels:dadosNormalizados.map(a=>a.data),datasets:[{label:"GGR Diário",data:dadosNormalizados.map(a=>a.ggr),borderColor:"lime",borderWidth:2}]},options:{responsive:!0}}),new Chart(document.getElementById("graficoFTD"),{type:"line",data:{labels:dadosNormalizados.map(a=>a.data),datasets:[{label:"FTD Diário",data:dadosNormalizados.map(a=>a.ftd),borderColor:"yellow",borderWidth:2}]},options:{responsive:!0}}),new Chart(document.getElementById("graficoDepositos"),{type:"line",data:{labels:dadosNormalizados.map(a=>a.data),datasets:[{label:"Depósitos Diários",data:dadosNormalizados.map(a=>a.depositos),borderColor:"blue",borderWidth:2}]},options:{responsive:!0}})}window.addEventListener("load",carregarDados);
